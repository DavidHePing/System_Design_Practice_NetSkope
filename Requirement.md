constraint
internal service

requirement
group by time intreval
group by user
everything should can be scale out
should consider about sending email might be failed